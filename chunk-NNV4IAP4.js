import{a as xe}from"./chunk-6VAWEE5E.js";import{a as me}from"./chunk-LUSJALC7.js";import{a as be}from"./chunk-Q4GO5ARB.js";import{e as M,f as ye}from"./chunk-NFZ6GDEL.js";import{a as Se}from"./chunk-7L3MM22O.js";import{h as ve}from"./chunk-BYGHQCG7.js";import{a as _e,b as he,c as F}from"./chunk-Y2PXB5NQ.js";import{h as ge,i as B,j as fe}from"./chunk-ZYGI2F2J.js";import"./chunk-JEWDWJGV.js";import"./chunk-DTTFVCDB.js";import{$a as I,Aa as pe,Sa as ue,b as le,ta as de,wa as ce}from"./chunk-ZAHCPB2U.js";import{$ as u,$b as Q,Bb as Y,Bc as re,Cb as E,Cc as D,Db as P,E as W,Eb as n,Ec as y,Fb as r,Gb as g,H as z,Kb as A,Mb as O,Nb as p,Sc as ne,Uc as ae,Vc as oe,Wb as J,Xa as l,Xb as o,Yb as j,Zb as c,_b as G,_c as se,ac as K,bc as Z,fc as ee,ga as k,gc as V,ha as C,hb as w,ic as q,mb as v,nc as te,p as R,pc as ie,q as $,ub as f,vb as X,wa as x,zb as _}from"./chunk-24CHYTPN.js";import{a as L,b as H}from"./chunk-TSRGIXR5.js";var Ee=(a,t)=>({"border-blue-500":a,"border-tertiary-300 dark:border-gray-800":t}),Pe=()=>["07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00"],De=()=>[],Me=(a,t)=>({"border-blue-500 hover:bg-blue-300":a,"border-red-500 hover:bg-red-300":t}),Ie=(a,t)=>t.user.id,Fe=(a,t)=>t.id;function Ne(a,t){if(a&1&&(n(0,"div",12)(1,"span",17),o(2),r()()),a&2){let e=t.$implicit;l(2),c(" ",e," ")}}function Ue(a,t){a&1&&g(0,"div",18)}function Re(a,t){a&1&&(n(0,"div",22),g(1,"fc-icon",23),n(2,"p",24),o(3,"No timelog Progress Yet"),r()()),a&2&&(l(),f("icon","boxTime"))}function $e(a,t){if(a&1&&(n(0,"div",31)(1,"div")(2,"span",32),o(3," Stop At "),r(),n(4,"div",33),o(5),r()()()),a&2){let e=p().$implicit,i=p(2);l(5),c(" ",i.getTime(e.stop_time)," ")}}function Ae(a,t){if(a&1&&(n(0,"div",31)(1,"div")(2,"span",32),o(3," Running Time "),r(),n(4,"div",33),o(5),r()()()),a&2){let e=p().$implicit,i=p(2);l(5),c(" ",i.elapsedTimes()[e.id]||i.getDurationString(e.start_time,e.stop_time)," ")}}function Oe(a,t){if(a&1&&(n(0,"div",31)(1,"div")(2,"span",32),o(3," For "),r(),n(4,"div",33),o(5),r()()()),a&2){let e=p().$implicit;l(5),c(" ",e.durationDisplay," ")}}function je(a,t){if(a&1&&o(0),a&2){let e=p().$implicit,i=p(2);c(" ",i.getTime(e.stop_time)," ")}}function Ve(a,t){if(a&1&&o(0),a&2){let e=p().$implicit,i=p(2);c(" ",i.elapsedTimes()[e.id]," ")}}function qe(a,t){if(a&1){let e=A();n(0,"p-popover",25,1)(2,"div",26)(3,"div",27)(4,"h3",28),o(5),r()(),g(6,"div",29),n(7,"div",30)(8,"div",31)(9,"div")(10,"span",32),o(11," Due Date "),r(),n(12,"div",33),o(13),te(14,"date"),r()()(),n(15,"div",31)(16,"div")(17,"span",32),o(18," Priority "),r(),n(19,"div",33),o(20),r()()(),n(21,"div",31)(22,"div")(23,"span",32),o(24," Started At "),r(),n(25,"div",33),o(26),r()()(),v(27,$e,6,1,"div",31)(28,Ae,6,1,"div",31)(29,Oe,6,1,"div",31),n(30,"div",34)(31,"div",35)(32,"span",32),o(33," Status "),r(),n(34,"span",36),o(35),r()()()()()(),n(36,"div",37),O("click",function(s){k(e);let m=J(1);return C(m.toggle(s))}),n(37,"div",38)(38,"span",39),o(39),r(),n(40,"div",31)(41,"span",40),o(42),r(),n(43,"span",41),o(44,"-"),r(),n(45,"span",42),v(46,je,1,1)(47,Ve,1,1),r()()()()}if(a&2){let e=t.$implicit,i=p(2);f("appendTo","body"),l(5),c(" ",(e.task_todo==null?null:e.task_todo.assignment)||"Untitled Task"," "),l(8),c(" ",ie(14,17,e.task_todo==null||e.task_todo.task==null?null:e.task_todo.task.due_date,"mediumDate")," "),l(7),c(" ",(e.task_todo==null||e.task_todo.task==null?null:e.task_todo.task.priority_level)||"Not Set"," "),l(6),c(" ",i.getTime(e.start_time)," "),l(),_(e.stop_time!==null?27:-1),l(),_(e.stop_time===null?28:29),l(7),c(" ",e.stop_time?"Completed":"In Progress"," "),l(),X("top",i.getTopOffset(e.start_time),"px")("height",i.getDurationInMinutes(e.start_time,e.stop_time)*i.PIXELS_PER_MINUTE+21,"px"),f("ngClass",q(20,Me,e.stop_time===null,e.stop_time!==null)),l(3),c(" ",e.task_todo.assignment," "),l(3),j(i.getTime(e.start_time)),l(3),f("ngClass",e.stop_time?"text-red-600 dark:text-red-400":"text-blue-700 dark:text-blue-300"),l(),_(e.stop_time!==null?46:47)}}function Be(a,t){if(a&1&&(n(0,"div",16)(1,"div",19)(2,"span",20),o(3),r(),n(4,"span",21),o(5),r()(),v(6,Re,4,1,"div",22),E(7,qe,48,23,null,null,Fe),r()),a&2){let e=t.$implicit;l(3),j(e.user.username),l(2),c("( ",e.user.name," )"),l(),_(e.timelogs.length===0?6:-1),l(),P(e.timelogs)}}var N=class a{assignmentService=u(xe);dialogRefService=u(me);dialogService=u(B);authService=u(M);userService=u(F);elapsedTimes=x({});isSearchFocus=x(!1);search=x("");debounceSearch=he(_e(this.search).pipe(W(311),z()),{initialValue:""});users=x([]);userResource=y({request:()=>({q:this.debounceSearch()}),loader:({request:t,abortSignal:e})=>{let i=new URLSearchParams({q:String(t.q)}).toString(),s=be(e);return R(this.userService.getUsers(i).pipe($(m=>{this.users.set(m.users),console.log(this.users())})))}});timelogs=x([]);timelogResource=y({request:()=>({user_id:this.authService.userData()?.id}),loader:({request:t})=>R(this.assignmentService.getTaskTimelogWithoutLimit("").pipe($(e=>{console.log(e);let i={};e.timelogs.forEach(s=>{s.stop_time&&(s.durationDisplay=this.getMinutesDiff(s.start_time,s.stop_time)),s&&s.start_time&&!s.stop_time&&this.startTimelogCounter(s.id,s.start_time),i[s.user_id]||(i[s.user_id]=[]),i[s.user_id].push(s)}),this.timelogs.set(i)})))});timelogsByUser=re(()=>{let t=this.timelogs();return this.users().map(i=>({user:i,timelogs:t[i.id]||[]}))});constructor(){D(()=>{let t=this.timelogs();t?.length&&t.map(e=>{e.stop_time&&(e.durationDisplay=this.getMinutesDiff(e.start_time,e.stop_time)),e&&e.start_time&&!e.stop_time&&this.startTimelogCounter(e.id,e.start_time)})}),setInterval(()=>{this.timelogResource.reload()},5e3)}PIXELS_PER_MINUTE=72/60;START_HOUR=6;OFFSET_Y=7;getTopOffset(t){let e=new Date(t),i=e.getHours()*60+e.getMinutes(),s=this.START_HOUR*60,m=i-s;return Math.max(0,Math.min(m,660))*this.PIXELS_PER_MINUTE+this.OFFSET_Y}getDurationInMinutes(t,e){let i=new Date(t).getTime(),s=e?new Date(e).getTime():Date.now();return Math.max(0,Math.floor((s-i)/1e3/60))}getTime(t){let e=new Date(t),i=e.getHours(),s=e.getMinutes(),m=i>=12?"PM":"AM";return i=i%12,i=i||12,`${i}:${s.toString().padStart(2,"0")} ${m}`}getDurationString(t,e){if(!t||!e)return"00:00:00";let i=new Date(t).getTime(),s=new Date(e).getTime(),m=Math.max(0,Math.floor((s-i)/1e3)),d=Math.floor(m/3600);m%=3600;let h=Math.floor(m/60),b=m%60,S=T=>T.toString().padStart(2,"0");return`${S(d)}:${S(h)}:${S(b)}`}getMinutesDiff(t,e){if(!e)return"Running\u2026";let i=new Date(t),s=new Date(e);if(isNaN(i.getTime())||isNaN(s.getTime()))return"Invalid time";let m=s.getTime()-i.getTime(),d=Math.floor(m/(1e3*60));if(d<0)return"Invalid duration";let h=Math.floor(d/60),b=d%60;return h>0?`${h} h ${b} m`:`${b} minutes`}startTimelogCounter(t,e){let i=new Date(e).getTime(),s=()=>{let m=Date.now()-i,d=Math.floor(m/1e3),h=Math.floor(d/3600),b=Math.floor(d%3600/60),S=d%60,T=U=>U.toString().padStart(2,"0");this.elapsedTimes.update(U=>H(L({},U),{[t]:`${T(h)}:${T(b)}:${T(S)}`}))};s(),setInterval(s,1e3)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["timelog-progress-tracker"]],features:[ee([B])],decls:19,vars:9,consts:[["searchInput",""],["timelogDetail",""],[1,"rounded-xl","border","border-gray-300","dark:border-gray-700","dark:bg-gray-900"],[1,"flex","items-center","justify-between","border-b","border-gray-300","p-4","dark:border-gray-700"],[1,"text-center","text-lg","font-bold","text-gray-900","dark:text-gray-100"],[1,"xs:max-w-60","relative","flex","h-full","w-full","items-center","gap-2","rounded-lg","border","bg-white","pl-3","dark:bg-gray-800",3,"ngClass"],[1,"grid","place-items-center","rounded-md"],[1,"text-sm","text-gray-600","dark:text-gray-400",3,"icon"],["type","text","placeholder","Search",1,"placeholder-tertiary-400","w-full","items-center","bg-transparent","py-1.5","pr-10","text-xs","text-gray-900","duration-100","focus:border-transparent","focus:outline-none","dark:text-gray-100","dark:placeholder-gray-400",3,"ngModelChange","focus","blur","ngModel"],[1,"space-y-4","overflow-x-auto","overflow-y-hidden","rounded-2xl","bg-white","font-sans","dark:bg-gray-900"],[1,"flex","w-full","min-w-max"],[1,"sticky","left-0","z-10","flex","flex-col","bg-white","px-5","pt-14","text-right","dark:bg-gray-900"],[1,"flex","h-18","items-center","justify-center"],[1,"relative","flex","w-full","min-w-min"],[1,"absolute","top-5","bottom-0","w-full"],["class","h-18 w-full border-b border-dashed border-gray-300 dark:border-gray-700",4,"ngFor","ngForOf"],[1,"relative","min-w-[15rem]","border-r","border-gray-300","pt-5","dark:border-gray-700"],[1,"flex","w-[3.4rem]","items-center","justify-center","rounded-sm","bg-gray-100","px-2","py-1","text-xs","text-black","dark:bg-gray-700","dark:text-gray-300"],[1,"h-18","w-full","border-b","border-dashed","border-gray-300","dark:border-gray-700"],[1,"flex","h-fit","flex-col","items-center","justify-center","text-gray-700","dark:text-gray-200"],[1,"font-bold"],[1,"text-xs"],[1,"mt-8","flex","h-[93%]","w-full","flex-col","items-center","justify-start","bg-gray-100/50","py-6","pt-[20%]","text-gray-500","dark:bg-gray-700/50","dark:text-gray-300"],[1,"text-xl","dark:text-gray-300",3,"icon"],[1,"mt-2","text-xs"],[3,"appendTo"],[1,"w-72","max-w-xs","rounded-lg","p-4"],[1,"mb-3"],[1,"text-base","font-semibold","text-gray-900","dark:text-gray-100"],[1,"mb-3","border-t","border-gray-200","dark:border-gray-700"],[1,"space-y-2","text-sm"],[1,"flex","items-center","gap-2"],[1,"text-xs","font-medium","tracking-wide","text-gray-500","uppercase","dark:text-gray-400"],[1,"font-medium","text-gray-900","dark:text-gray-100"],[1,"mt-2","border-t","border-gray-100","pt-2","dark:border-gray-700"],[1,"flex","items-center","justify-between"],[1,"rounded-full","bg-blue-100","px-2","py-1","text-xs","font-medium","text-blue-800","dark:bg-blue-900","dark:text-blue-200"],[1,"absolute","left-1/2","h-1","w-[90%]","-translate-x-1/2","cursor-pointer","rounded-sm","border-t-4","bg-gradient-to-r","bg-[linear-gradient(45deg,#00000010_25%,transparent_25%,transparent_50%,#00000010_50%,#00000010_75%,transparent_75%,transparent)]","from-blue-500/50","to-blue-500/50","bg-[length:1rem_1rem]","duration-150","hover:bg-none",3,"click","ngClass"],[1,"-mt-5","flex","items-center","justify-between","gap-2"],[1,"truncate","text-xs","font-semibold","text-gray-900","uppercase","dark:text-gray-100"],[1,"text-xs","font-medium","text-nowrap","text-green-600"],[1,"text-xs","font-medium","text-nowrap"],[1,"text-xs","font-medium","text-nowrap",3,"ngClass"]],template:function(e,i){if(e&1){let s=A();n(0,"div",2)(1,"div",3)(2,"h2",4),o(3," Task Timelog Progresses "),r(),n(4,"div",5)(5,"div",6),g(6,"fc-icon",7),r(),n(7,"input",8,0),Z("ngModelChange",function(d){return k(s),K(i.search,d)||(i.search=d),C(d)}),O("focus",function(){return k(s),C(i.isSearchFocus.set(!0))})("blur",function(){return k(s),C(i.isSearchFocus.set(!1))}),r()()(),n(9,"div",9)(10,"div",10)(11,"div",11),E(12,Ne,3,1,"div",12,Y),r(),n(14,"div",13)(15,"div",14),v(16,Ue,1,0,"div",15),r(),E(17,Be,9,3,"div",16,Ie),r()()()()}e&2&&(l(4),f("ngClass",q(4,Ee,i.isSearchFocus(),!i.isSearchFocus())),l(2),f("icon","search"),l(),Q("ngModel",i.search),l(5),P(V(7,Pe)),l(4),f("ngForOf",V(8,De).constructor(33)),l(),P(i.timelogsByUser()))},dependencies:[I,de,ce,pe,ne,ae,ue,se,ge,ve,fe],encapsulation:2})};function Le(a,t){if(a&1&&(n(0,"div",5)(1,"div",6)(2,"div",7)(3,"span",8),o(4," Total Employees "),r(),g(5,"div",9),r(),n(6,"div",10)(7,"span",11),o(8),r()(),n(9,"p",12),o(10," Registered employee in the system "),r()(),n(11,"div",6)(12,"div",7)(13,"span",8),o(14," Present Today "),r(),g(15,"div",13),r(),n(16,"div",10)(17,"span",11),o(18),r()(),n(19,"p",12),o(20," Employees currently marked present "),r()(),n(21,"div",6)(22,"div",7)(23,"span",8),o(24," Not Present "),r(),g(25,"div",14),r(),n(26,"div",10)(27,"span",11),o(28),r()(),n(29,"p",12),o(30," Employees not yet to check in today "),r()(),n(31,"div",6)(32,"div",7)(33,"span",8),o(34," On Leave / Permission "),r(),g(35,"div",15),r(),n(36,"div",10)(37,"span",11),o(38),r()(),n(39,"p",12),o(40," Employee permission for today "),r()()()),a&2){let e,i,s,m,d=p();l(8),c(" ",(e=d.attendanceSummary.value())==null?null:e.total_user," "),l(10),c(" ",(i=d.attendanceSummary.value())==null?null:i.total_present," "),l(10),c(" ",(s=d.attendanceSummary.value())==null?null:s.total_not_present," "),l(10),c(" ",(m=d.attendanceSummary.value())==null?null:m.total_permission," ")}}function He(a,t){a&1&&g(0,"timelog-progress-tracker")}var Te=class a{http=u(le);userService=u(F);layoutService=u(ye);authService=u(M);attendanceService=u(Se);currentUserPage=x(1);attendanceSummary=y({loader:()=>this.attendanceService.getAttendanceSummarize().toPromise()});users=y({request:()=>({page:this.currentUserPage()}),loader:({request:t})=>{let e=new URLSearchParams({limit:"20",page:String(t.page)}).toString();return this.userService.getUsers(e).toPromise()}});attendances=[];headers=[];bodies=[];pagination;countSnapshot;nextPage(){this.currentUserPage.update(t=>t<this.users.value().totalPages?t+1:t)}prevPage(){this.currentUserPage.update(t=>Math.max(1,t-1))}constructor(){console.log(this.authService.userData()),this.layoutService.currentPageName.set("Dashboard"),D(()=>{console.log(this.users.value()),this.users.value()?.users&&(this.bodies=this.users.value().users.map(t=>({name:{name:t.name,hideable:!1},username:{name:t.username,hideable:!1},phone:{name:t.phone,hideable:!0},email:{name:t.email,hideable:!1}})),this.pagination={nextPage:()=>this.nextPage(),prevPage:()=>this.prevPage(),currentPage:this.users.value().currentPage,totalPage:this.users.value().totalPages},this.countSnapshot=this.users.value()?.count),console.log(this.bodies),console.log(this.pagination)}),this.attendances=[{id:1,onTime:8,late:3,total:11}],this.headers=[{name:"#",key:"",hideable:!1},{name:"Name",key:"name",hideable:!1},{name:"Username",key:"username",hideable:!1},{name:"Phone",key:"phone",hideable:!0},{name:"Email",key:"email",hideable:!1}]}onRowClick(t){console.log("Row clicked:",t)}userName=this.authService.userData().username;todos=[{title:"Add your company logo",description:"Pull your company logo and brand into Jobber to use on quotes, invoices, job forms"},{title:"Explore your personalized online client portal",description:"Clients can approved quotes, review jobs, and pay all online"},{title:"Set up your service categories",description:"Organize your services to streamline job creation and pricing"},{title:"Configure payment methods",description:"Enable online payments to get paid faster and reduce admin work"}];projects=[{name:"Website Redesign",status:"In Progress",progress:75,initials:"WR",color:"bg-blue-500"},{name:"Mobile App",status:"Planning",progress:25,initials:"MA",color:"bg-green-500"},{name:"Brand Identity",status:"Review",progress:90,initials:"BI",color:"bg-purple-500"},{name:"Marketing Campaign",status:"Active",progress:60,initials:"MC",color:"bg-orange-500"}];recentUpdates=[{title:"Quote #1245 was approved by client",time:"2 minutes ago"},{title:"New job request from Sarah Johnson",time:"15 minutes ago"},{title:"Invoice #987 payment received",time:"1 hour ago"},{title:"Team meeting scheduled for tomorrow",time:"2 hours ago"},{title:"Monthly report generated successfully",time:"3 hours ago"}];getTimeOfDay(){let t=new Date().getHours();return t<12?"morning":t<17?"afternoon":"evening"}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["dashboard"]],decls:7,vars:4,consts:[[1,"animateDiv","flex","h-full","min-h-0","w-full","flex-col","gap-6"],[1,"flex","flex-col","items-center"],[1,"text-2xl","font-semibold","text-gray-900","capitalize","sm:text-3xl","dark:text-gray-100"],["class","grid grid-cols-2 gap-6 lg:grid-cols-4",4,"ngIf"],[1,"grid","h-full","grid-cols-1","gap-6"],[1,"grid","grid-cols-2","gap-6","lg:grid-cols-4"],[1,"rounded-xl","px-5","py-4","dark:bg-gray-900"],[1,"mb-2","flex","items-center","gap-3"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"h-2","w-2","rounded-full","bg-blue-500"],[1,"flex","items-baseline","gap-2"],[1,"text-2xl","font-semibold","text-gray-900","dark:text-gray-100"],[1,"mt-1","text-xs","text-gray-500","dark:text-gray-400"],[1,"h-2","w-2","rounded-full","bg-green-500"],[1,"h-2","w-2","rounded-full","bg-red-500"],[1,"h-2","w-2","rounded-full","bg-yellow-500"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),o(3),r()(),v(4,Le,41,4,"div",3),n(5,"div",4),v(6,He,1,0,"timelog-progress-tracker"),r()()),e&2&&(l(3),G(" Good ",i.getTimeOfDay(),", ",i.userName," "),l(),f("ngIf",i.authService.userData().division_id===1),l(2),_(i.authService.userData().division_id===2?6:-1))},dependencies:[I,oe,N],encapsulation:2})};export{Te as DashboardComponent};
